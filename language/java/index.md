---
title: Java
---

## JDK1.7 新特性

　　OpenJDK中的[Coin](http://openjdk.java.net/projects/coin/) 项目目的是维护对Java语言所做的语言增强。          

- switch中使用字符串        
　　Java1.7之前，switch中的条件表达式的类型只能与整数型兼容的类型。           
　　　比如基本类型char、byte、short和int.还有这些基本类型对应的封装类。        
　　　另外还有一个枚举类           
　　问题：    
　　　1.如果表达式的值为null，会抛出NPE（NullPointerException）         
　　　2.如果case的值为null，编译是无法通过的。           
　　　3.如果case的值是相等的，编译也是无法通过的。比如“男”和“\u7537"       
　　新特性是在编译器层次实现的，而在Java虚拟机和字节代码这个层次上，还是只支持在switch语句中使用与整数类型兼容的类型。这样做的目的是为了减少这个特性所影响的范围，以降低实现的代价。      
　　OpenJDK中String比较实现。先会利用哈希函数将字符串转换为哈希值，利用hash值来swtich选择哪个条件，不过在哈希值里面回去用if判断传入的值和case的值是否相等。因为哈希函数在映射的时候可能存在冲突，多个字符串的哈希值可能是一样的。             
　　如果在switch中使用字符串作为表达式，建议考虑用枚举类型进行替换。           
- 数值字面量的改进      
  - 二进制整形字面量         
　　　Java1.7之前所支持的进制包括十进制、八进制和十六进制。十进制是默认使用的进制。八进制是用在整数字面量之前添加“0”来表示，而十六进制则是用在整数字面之前添加“0x”或“0X”来表达。而Java7中增加了一种可以在字面量中使用的进制，即二进制。二进制通过在数字前面添加“0b”或者“0B”来表示。              
  - 在数值字面量中使用下划线           
　　　数值字面中用下划线来分割。最基本的原则是下划线只能出现在数字中间。     
　　　比如：100_000_000  ,编译过程中将下划线删除。         
- 优化的异常处理
　　两个重要的改动：        
　　　1.支持在一个catch子句中同时捕获多个异常。
　　　2.在捕获并重新抛出异常时的异常类型更加精确。
   - 异常的基础知识
　　　Java基本的异常处理是围绕try-catch-finally、throws和throw这几个关键词展开的，             
　　　throws用来声明一个方法可能抛出的异常，对方法体中可能抛出的异常都要进行声明；                  
　　　throw用来在遇到错误的时候抛出一个具体的异常。                      
　　　try-catch-finally用来捕获异常并进行处理。         
   - 受检异常和非受检异常           
　　　受检异常（checked exception）和非受检异常（unchecked exception）。非受检异常指的是java.lang.RuntimeException和java.lang.Error类 及其子类，所有其他的异常都成为受检异常。两种类型的异常在作用上并没有差别。唯一的差别就在于使用受检异常时的合法性要在编译时刻由编译器来检查。            
  - 异常声明是API的一部分               
　　　对于API的设计者来说，谨慎考虑每个公开方法所声明的异常是很有必要的。        
  - 创建自已的异常        
     - 精心设计异常的层次结构          
　　　　在使用异常包装的时候，一个典型的做法就是为每个层次定义一个基本的异常类。           
     - 异常类中包含足够的信息                 
　　　　提供给用户更加具体的出错信息以及更加明确的解决方案           
     - 异常与错误提示               
　　　　比如国际化的异常信息提示             
  - 处理异常        
　　　　“消失的异常”：比如后抛出的异常把前面的异常覆盖。 这种问题的两种解决办法：一种是抛出try语句块中产生的原是异常。第二种是把所有的异常信息都记录起来。          

- try-with-resources语句

　　　使用try语句进行资源管理的新用法。原则：谁申请，谁释放。      

　　　